datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  discordId                 String   @id @unique
  minecraftUuid             String?  @unique
  openTicketChannelId       String?  @unique
  guildApplicationChannelId String?  @unique
  timeJoinedWaitlist        BigInt?
  frozenOnWaitlist          Boolean?
  informedOnWaitlist        Boolean?
  username                  String?
  discriminator             String?
  accessToken               String?
  refreshToken              String?
  tokenExpires              BigInt?
}

model Guild {
  guildId              String    @id
  waitlistJoinMessage  String    @default("You are now on the waitlist")
  ticketRoleIds        String[]
  applicationQuestions String[]
  channels             Channel[]
  roles                Role[]
}

enum RoleType {
  DISCORD_STAFF
  GUILD_STAFF
  APPLICATIONS_TEAM
  WAITLIST
}

model Role {
  roleId  String
  guildId String
  guild   Guild  @relation(fields: [guildId], references: [guildId])

  roleType RoleType

  @@id([roleId, guildId])
}

enum ChannelType {
  WAITLIST
  SUGGESTIONS
  GUILD_BRIDGE
}

model Channel {
  channelId String
  guildId   String
  guild     Guild  @relation(fields: [guildId], references: [guildId])

  channelType ChannelType

  @@id([channelId, guildId])
}
